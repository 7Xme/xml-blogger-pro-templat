<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Quality Analyzer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #e53e3e 0%, #c53030 100%);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            background: linear-gradient(45deg, #e53e3e, #c53030);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .upload-section {
            margin-bottom: 30px;
            text-align: center;
        }
        .upload-area {
            border: 3px dashed #e53e3e;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            margin-bottom: 20px;
            background: rgba(229, 62, 62, 0.05);
        }
        .upload-area:hover, .upload-area.dragover {
            border-color: #c53030;
            background: rgba(229, 62, 62, 0.1);
            transform: scale(1.02);
        }
        .upload-area input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        .upload-icon {
            font-size: 48px;
            color: #e53e3e;
            margin-bottom: 15px;
            filter: drop-shadow(0 0 10px rgba(229, 62, 62, 0.5));
        }
        .upload-text {
            font-size: 18px;
            color: #333;
            margin-bottom: 10px;
        }
        .upload-subtext {
            font-size: 14px;
            color: #666;
        }
        .preview-section {
            display: none;
            margin-bottom: 30px;
            text-align: center;
        }
        .preview-container {
            display: inline-block;
            border: 3px solid #e53e3e;
            border-radius: 15px;
            padding: 20px;
            background: white;
            box-shadow: 0 8px 25px rgba(229, 62, 62, 0.2);
        }
        .preview-image {
            max-width: 300px;
            max-height: 300px;
            border-radius: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .analysis-section {
            display: none;
            margin-bottom: 30px;
        }
        .analysis-container {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
        }
        .analysis-title {
            font-size: 24px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }
        .quality-score {
            text-align: center;
            margin-bottom: 30px;
        }
        .score-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: 600;
            color: white;
            margin: 0 auto 15px;
            position: relative;
        }
        .score-label {
            font-size: 16px;
            color: #666;
        }
        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        .metric-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .metric-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        .metric-icon {
            font-size: 24px;
            margin-right: 10px;
            color: #e53e3e;
        }
        .metric-name {
            font-weight: 600;
            color: #333;
        }
        .metric-score {
            font-size: 24px;
            font-weight: 600;
            color: #e53e3e;
            margin-bottom: 10px;
        }
        .metric-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .metric-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 1s ease;
        }
        .metric-description {
            font-size: 14px;
            color: #666;
        }
        .suggestions-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .suggestions-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
        }
        .suggestion-item {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .suggestion-icon {
            font-size: 18px;
            color: #e53e3e;
            margin-right: 15px;
            margin-top: 2px;
        }
        .suggestion-text {
            flex: 1;
            color: #333;
        }
        .status {
            padding: 15px;
            border-radius: 8px;
            margin-top: 20px;
            display: none;
        }
        .status.success {
            background: rgba(40, 167, 69, 0.1);
            color: #28a745;
            border: 1px solid #28a745;
        }
        .status.error {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
            border: 1px solid #dc3545;
        }
        @media (max-width: 768px) {
            .container {
                padding: 20px;
            }
            .upload-area {
                padding: 30px 20px;
            }
            .metrics-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üîç Image Quality Analyzer</h1>

        <div class="upload-section">
            <div class="upload-area" id="uploadArea">
                <input type="file" id="imageFile" accept="image/*">
                <div class="upload-icon">üìä</div>
                <div class="upload-text">Drop image here or click to browse</div>
                <div class="upload-subtext">Analyze JPG, PNG, WebP (max 10MB)</div>
            </div>
        </div>

        <div class="preview-section" id="previewSection">
            <div class="preview-container">
                <img id="previewImage" class="preview-image" alt="Preview">
            </div>
        </div>

        <div class="analysis-section" id="analysisSection">
            <div class="analysis-container">
                <div class="analysis-title">üìà Quality Analysis Results</div>
                <div class="quality-score">
                    <div class="score-circle" id="overallScore"></div>
                    <div class="score-label">Overall Quality Score</div>
                </div>
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon">üîç</div>
                            <div class="metric-name">Sharpness</div>
                        </div>
                        <div class="metric-score" id="sharpnessScore">0</div>
                        <div class="metric-bar">
                            <div class="metric-fill" id="sharpnessBar" style="background: linear-gradient(90deg, #e53e3e, #38a169);"></div>
                        </div>
                        <div class="metric-description">Measures edge definition and clarity</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon">üì∏</div>
                            <div class="metric-name">Noise Level</div>
                        </div>
                        <div class="metric-score" id="noiseScore">0</div>
                        <div class="metric-bar">
                            <div class="metric-fill" id="noiseBar" style="background: linear-gradient(90deg, #38a169, #e53e3e);"></div>
                        </div>
                        <div class="metric-description">Detects unwanted grain and artifacts</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon">üóúÔ∏è</div>
                            <div class="metric-name">Compression</div>
                        </div>
                        <div class="metric-score" id="compressionScore">0</div>
                        <div class="metric-bar">
                            <div class="metric-fill" id="compressionBar" style="background: linear-gradient(90deg, #e53e3e, #38a169);"></div>
                        </div>
                        <div class="metric-description">Assesses compression artifacts</div>
                    </div>
                    <div class="metric-card">
                        <div class="metric-header">
                            <div class="metric-icon">üåà</div>
                            <div class="metric-name">Color Accuracy</div>
                        </div>
                        <div class="metric-score" id="colorScore">0</div>
                        <div class="metric-bar">
                            <div class="metric-fill" id="colorBar" style="background: linear-gradient(90deg, #e53e3e, #38a169);"></div>
                        </div>
                        <div class="metric-description">Evaluates color reproduction quality</div>
                    </div>
                </div>
            </div>

            <div class="suggestions-section">
                <div class="suggestions-title">üí° Improvement Suggestions</div>
                <div id="suggestionsList"></div>
            </div>
        </div>

        <div class="status" id="status"></div>
    </div>

    <script>
        let image = null;

        // DOM elements
        const imageFile = document.getElementById('imageFile');
        const uploadArea = document.getElementById('uploadArea');
        const previewSection = document.getElementById('previewSection');
        const previewImage = document.getElementById('previewImage');
        const analysisSection = document.getElementById('analysisSection');
        const statusDiv = document.getElementById('status');

        // Event listeners
        imageFile.addEventListener('change', handleFileSelect);
        uploadArea.addEventListener('dragover', handleDragOver);
        uploadArea.addEventListener('dragleave', handleDragLeave);
        uploadArea.addEventListener('drop', handleFileDrop);

        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file && file.type.startsWith('image/')) {
                if (file.size > 10 * 1024 * 1024) {
                    showStatus('Image file size must be under 10MB. Please choose a smaller file.', 'error');
                    return;
                }
                processImage(file);
            } else {
                showStatus('Please select a valid image file.', 'error');
            }
        }

        function handleDragOver(event) {
            event.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave(event) {
            event.preventDefault();
            uploadArea.classList.remove('dragover');
        }

        function handleFileDrop(event) {
            event.preventDefault();
            uploadArea.classList.remove('dragover');

            const file = event.dataTransfer.files[0];
            if (file && file.type.startsWith('image/')) {
                if (file.size > 10 * 1024 * 1024) {
                    showStatus('Image file size must be under 10MB. Please choose a smaller file.', 'error');
                    return;
                }
                processImage(file);
                imageFile.files = event.dataTransfer.files;
            } else {
                showStatus('Please drop a valid image file.', 'error');
            }
        }

        function processImage(file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                image = new Image();
                image.onload = function() {
                    previewImage.src = e.target.result;
                    previewSection.style.display = 'block';
                    analyzeImage(file);
                    showStatus(`Quality analysis completed for "${file.name}".`, 'success');
                };
                image.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function analyzeImage(file) {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = image.width;
            canvas.height = image.height;
            ctx.drawImage(image, 0, 0);

            const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
            const data = imageData.data;

            // Analyze different quality metrics
            const sharpness = analyzeSharpness(data, canvas.width, canvas.height);
            const noise = analyzeNoise(data, canvas.width, canvas.height);
            const compression = analyzeCompression(file);
            const colorAccuracy = analyzeColorAccuracy(data);

            // Calculate overall score
            const overallScore = Math.round((sharpness + (100 - noise) + compression + colorAccuracy) / 4);

            // Update UI
            updateQualityScore(overallScore);
            updateMetric('sharpness', sharpness);
            updateMetric('noise', 100 - noise);
            updateMetric('compression', compression);
            updateMetric('color', colorAccuracy);

            // Generate suggestions
            generateSuggestions(sharpness, noise, compression, colorAccuracy);

            analysisSection.style.display = 'block';
        }

        function analyzeSharpness(data, width, height) {
            // Simple sharpness analysis using edge detection
            let edgeSum = 0;
            let pixelCount = 0;

            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    const idx = (y * width + x) * 4;
                    const gray = (data[idx] + data[idx + 1] + data[idx + 2]) / 3;

                    // Sobel operator for edge detection
                    const gx = -gray + data[((y-1)*width + (x+1))*4] + 
                              -2 * data[(y*width + (x-1))*4] + 2 * data[(y*width + (x+1))*4] +
                              -data[((y+1)*width + (x-1))*4] + data[((y+1)*width + (x+1))*4];

                    const gy = -data[((y-1)*width + (x-1))*4] - 2 * data[((y-1)*width + x)*4] - data[((y-1)*width + (x+1))*4] +
                              data[((y+1)*width + (x-1))*4] + 2 * data[((y+1)*width + x)*4] + data[((y+1)*width + (x+1))*4];

                    const edge = Math.sqrt(gx * gx + gy * gy);
                    edgeSum += edge;
                    pixelCount++;
                }
            }

            const avgEdge = edgeSum / pixelCount;
            return Math.min(100, Math.max(0, avgEdge / 2)); // Normalize to 0-100
        }

        function analyzeNoise(data, width, height) {
            // Simple noise analysis using pixel variance
            let varianceSum = 0;
            let pixelCount = 0;

            for (let y = 1; y < height - 1; y++) {
                for (let x = 1; x < width - 1; x++) {
                    const idx = (y * width + x) * 4;
                    const gray = (data[idx] + data[idx + 1] + data[idx + 2]) / 3;

                    // Calculate local variance
                    let localSum = 0;
                    let localCount = 0;
                    for (let dy = -1; dy <= 1; dy++) {
                        for (let dx = -1; dx <= 1; dx++) {
                            const nidx = ((y + dy) * width + (x + dx)) * 4;
                            const ngray = (data[nidx] + data[nidx + 1] + data[nidx + 2]) / 3;
                            localSum += ngray;
                            localCount++;
                        }
                    }

                    const localMean = localSum / localCount;
                    const diff = gray - localMean;
                    varianceSum += diff * diff;
                    pixelCount++;
                }
            }

            const avgVariance = varianceSum / pixelCount;
            return Math.min(100, Math.max(0, avgVariance / 50)); // Normalize to 0-100
        }

        function analyzeCompression(file) {
            // Estimate compression quality based on file size vs pixel count
            const pixelCount = image.width * image.height;
            const bytesPerPixel = file.size / pixelCount;

            // Lower bytes per pixel suggests better compression
            if (bytesPerPixel < 1) return 90; // Very efficient
            if (bytesPerPixel < 2) return 75;
            if (bytesPerPixel < 3) return 60;
            return 40; // Poor compression
        }

        function analyzeColorAccuracy(data) {
            // Simple color analysis - check if colors are well distributed
            const colorCounts = {};
            let uniqueColors = 0;

            for (let i = 0; i < data.length; i += 4) {
                const key = `${data[i]},${data[i+1]},${data[i+2]}`;
                if (!colorCounts[key]) {
                    colorCounts[key] = 0;
                    uniqueColors++;
                }
                colorCounts[key]++;
            }

            // More unique colors = better color accuracy
            const ratio = uniqueColors / (data.length / 4);
            return Math.min(100, ratio * 1000);
        }

        function updateQualityScore(score) {
            const scoreCircle = document.getElementById('overallScore');
            scoreCircle.textContent = score;
            scoreCircle.style.background = score >= 80 ? '#38a169' : score >= 60 ? '#d69e2e' : '#e53e3e';
        }

        function updateMetric(type, score) {
            const scoreElement = document.getElementById(type + 'Score');
            const barElement = document.getElementById(type + 'Bar');

            scoreElement.textContent = Math.round(score);
            barElement.style.width = score + '%';

            // Update bar color based on score
            if (type === 'noise') {
                barElement.style.background = score >= 80 ? '#38a169' : score >= 60 ? '#d69e2e' : '#e53e3e';
            } else {
                barElement.style.background = score >= 80 ? '#38a169' : score >= 60 ? '#d69e2e' : '#e53e3e';
            }
        }

        function generateSuggestions(sharpness, noise, compression, colorAccuracy) {
            const suggestions = [];
            const suggestionsList = document.getElementById('suggestionsList');

            if (sharpness < 60) {
                suggestions.push('Consider using a tripod or image stabilization to reduce blur');
                suggestions.push('Increase ISO sensitivity or use better lighting for sharper images');
            }

            if (noise > 40) {
                suggestions.push('Use a lower ISO setting to reduce noise');
                suggestions.push('Apply noise reduction in post-processing software');
            }

            if (compression < 60) {
                suggestions.push('Save images in a lossless format like PNG for better quality');
                suggestions.push('Reduce JPEG compression level for higher quality');
            }

            if (colorAccuracy < 60) {
                suggestions.push('Calibrate your monitor for accurate color representation');
                suggestions.push('Use RAW format for better color information');
            }

            if (suggestions.length === 0) {
                suggestions.push('Great job! Your image quality is excellent.');
            }

            suggestionsList.innerHTML = suggestions.map(suggestion => `
                <div class="suggestion-item">
                    <div class="suggestion-icon">üí°</div>
                    <div class="suggestion-text">${suggestion}</div>
                </div>
            `).join('');
        }

        function showStatus(message, type) {
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
            statusDiv.style.display = 'block';

            // Auto hide after 5 seconds
            setTimeout(() => {
                statusDiv.style.display = 'none';
            }, 5000);
        }
    </script>
</body>
</html>