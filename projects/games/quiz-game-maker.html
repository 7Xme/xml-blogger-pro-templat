<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Game Maker</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            margin: 0;
            padding: 20px;
        }
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .tab-selector {
            display: flex;
            margin-bottom: 30px;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 5px;
        }
        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            padding: 10px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s ease;
        }
        .tab-btn.active {
            background: #dc143c;
            color: white;
        }
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .game-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            min-height: 400px;
        }
        .question-display {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .question-number {
            color: #666;
            margin-bottom: 10px;
        }
        .question-text {
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
        }
        .timer {
            font-size: 48px;
            font-weight: bold;
            color: #dc143c;
            margin: 20px 0;
        }
        .answers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .answer-option {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 16px;
        }
        .answer-option:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        .answer-option.selected {
            background: #dc143c;
            color: white;
        }
        .answer-option.correct {
            background: #28a745;
            color: white;
        }
        .answer-option.incorrect {
            background: #dc3545;
            color: white;
        }
        .game-stats {
            display: flex;
            justify-content: space-around;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #dc143c;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
        }
        .nav-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: #5a6268;
            transform: scale(1.05);
        }
        .start-btn {
            background: #28a745;
        }
        .start-btn:hover {
            background: #218838;
        }
        .results-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .final-score {
            font-size: 64px;
            font-weight: bold;
            color: #dc143c;
            margin: 20px 0;
        }
        .achievement {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .achievement.unlocked {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        .retry-btn {
            background: #dc143c;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        .retry-btn:hover {
            background: #b22222;
            transform: scale(1.05);
        }
        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
            }
            .answers-grid {
                grid-template-columns: 1fr;
            }
            .game-stats {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>Quiz Game Maker</h1>

        <div class="tab-selector">
            <button class="tab-btn active" onclick="switchTab('play')">Play Game</button>
            <button class="tab-btn" onclick="switchTab('create')">Create Questions</button>
        </div>

        <div id="play" class="tab-content active">
            <div class="game-section" id="gameSection">
                <div class="game-stats">
                    <div class="stat">
                        <div class="stat-number" id="score">0</div>
                        <div class="stat-label">Score</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="questionNum">1</div>
                        <div class="stat-label">Question</div>
                    </div>
                    <div class="stat">
                        <div class="stat-number" id="streak">0</div>
                        <div class="stat-label">Streak</div>
                    </div>
                    <div class="stat">
                        <div class="timer" id="timer">30</div>
                        <div class="stat-label">Time Left</div>
                    </div>
                </div>

                <div class="question-display" id="questionDisplay">
                    <div class="question-number">Question 1 of 5</div>
                    <div class="question-text">Welcome to Quiz Game!</div>
                    <button class="start-btn nav-btn" onclick="startGame()">Start Game</button>
                </div>
            </div>

            <div class="results-section" id="resultsSection" style="display: none;">
                <h2>Game Over!</h2>
                <div class="final-score" id="finalScore">0</div>
                <div id="achievements"></div>
                <button class="retry-btn" onclick="retryGame()">Play Again</button>
            </div>
        </div>

        <div id="create" class="tab-content">
            <div class="game-section">
                <h2>Create Your Quiz Questions</h2>
                <div class="quiz-controls" style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                    <button class="nav-btn" onclick="addNewQuestion()" style="background: #28a745;">Add Question</button>
                    <button class="nav-btn" onclick="saveQuiz()" style="background: #007bff;">Save Quiz</button>
                    <button class="nav-btn" onclick="loadQuiz()" style="background: #6f42c1;">Load Quiz</button>
                    <button class="nav-btn" onclick="exportQuiz()" style="background: #fd7e14;">Export as HTML</button>
                    <button class="nav-btn" onclick="clearAllQuestions()" style="background: #dc3545;">Clear All</button>
                </div>

                <div id="questionList">
                    <!-- Questions will be loaded here -->
                </div>

                <div id="questionEditor" style="display: none; background: white; padding: 20px; border-radius: 10px; margin-top: 20px;">
                    <h3 id="editorTitle">Add New Question</h3>
                    <div style="margin-bottom: 15px;">
                        <label>Question:</label>
                        <input type="text" id="questionText" placeholder="Enter your question" style="width: 100%; padding: 10px; margin-top: 5px; border: 1px solid #ddd; border-radius: 5px;">
                    </div>
                    <div id="optionsContainer">
                        <label>Options:</label>
                        <div class="option-input" style="display: flex; gap: 10px; margin-top: 5px;">
                            <input type="text" class="optionText" placeholder="Option 1" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            <input type="radio" name="correctOption" value="0" checked>
                            <button onclick="removeOption(this)" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px;">×</button>
                        </div>
                        <div class="option-input" style="display: flex; gap: 10px; margin-top: 5px;">
                            <input type="text" class="optionText" placeholder="Option 2" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                            <input type="radio" name="correctOption" value="1">
                            <button onclick="removeOption(this)" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px;">×</button>
                        </div>
                    </div>
                    <button onclick="addOption()" style="background: #6c757d; color: white; border: none; padding: 8px 15px; border-radius: 5px; margin: 10px 0;">Add Option</button>
                    <div style="margin-top: 20px;">
                        <button onclick="saveQuestion()" style="background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; margin-right: 10px;">Save Question</button>
                        <button onclick="cancelEdit()" style="background: #6c757d; color: white; border: none; padding: 10px 20px; border-radius: 5px;">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Default questions (fallback)
        const defaultQuestions = [
            {
                question: "What is the capital of France?",
                options: ["London", "Berlin", "Paris", "Madrid"],
                correct: 2
            },
            {
                question: "What is 2 + 2?",
                options: ["3", "4", "5", "6"],
                correct: 1
            },
            {
                question: "What color is the sky on a clear day?",
                options: ["Green", "Blue", "Red", "Yellow"],
                correct: 1
            },
            {
                question: "Which of these is a programming language?",
                options: ["HTML", "JavaScript", "CSS", "XML"],
                correct: 1
            },
            {
                question: "What is the largest planet in our solar system?",
                options: ["Earth", "Mars", "Jupiter", "Saturn"],
                correct: 2
            }
        ]

        let questions = [];
        let currentQuestionIndex = 0;
        let score = 0;
        let streak = 0;
        let timeLeft = 30;
        let timerInterval;
        let gameStarted = false;
        let selectedAnswer = -1;
        let editingQuestionIndex = -1;

        // Auto-save functionality
        function saveToLocalStorage() {
            localStorage.setItem('quizGame_questions', JSON.stringify(questions));
            localStorage.setItem('quizGame_progress', JSON.stringify({
                currentQuestionIndex,
                score,
                streak,
                gameStarted
            }));
        }

        function loadFromLocalStorage() {
            const savedQuestions = localStorage.getItem('quizGame_questions');
            if (savedQuestions) {
                questions = JSON.parse(savedQuestions).filter(q => q !== null);
            } else {
                questions = [...defaultQuestions];
            }

            const savedProgress = localStorage.getItem('quizGame_progress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                currentQuestionIndex = progress.currentQuestionIndex || 0;
                score = progress.score || 0;
                streak = progress.streak || 0;
                gameStarted = progress.gameStarted || false;
            }
        }

        // Load data on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            renderQuestionList();
        });

        // Auto-save on changes
        function autoSave() {
            setTimeout(saveToLocalStorage, 100);
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById(tab).classList.add('active');

            if (tab === 'create') {
                renderQuestionList();
            }
        }

        function startGame() {
            if (questions.length === 0) {
                alert('Please add some questions first!');
                switchTab('create');
                return;
            }

            gameStarted = true;
            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            timeLeft = 30;
            selectedAnswer = -1;

            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('gameSection').style.display = 'block';

            updateStats();
            showQuestion();
            startTimer();
            autoSave();
        }

        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                endGame();
                return;
            }

            const question = questions[currentQuestionIndex];
            const questionDisplay = document.getElementById('questionDisplay');

            questionDisplay.innerHTML =
                '<div class="question-number">Question ' + (currentQuestionIndex + 1) + ' of ' + questions.length + '</div>' +
                '<div class="question-text">' + question.question + '</div>' +
                '<div class="answers-grid" id="answersGrid">' +
                    question.options.map((option, index) =>
                        '<div class="answer-option" onclick="selectAnswer(' + index + ')">' + option + '</div>'
                    ).join('') +
                '</div>' +
                '<button class="nav-btn" onclick="submitAnswer()" id="submitBtn" disabled>Submit Answer</button>';

            selectedAnswer = -1;
            updateStats();
        }

        function selectAnswer(index) {
            if (!gameStarted) return;

            selectedAnswer = index;
            document.querySelectorAll('.answer-option').forEach((el, i) => {
                el.classList.toggle('selected', i === index);
            });
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            if (selectedAnswer === -1) return;

            const question = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.answer-option');

            // Show correct/incorrect
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedAnswer) {
                    option.classList.add('incorrect');
                }
            });

            // Update score
            if (selectedAnswer === question.correct) {
                const timeBonus = Math.max(0, timeLeft * 10); // Bonus points for quick answers
                const streakBonus = streak * 50; // Bonus for streaks
                const points = 100 + timeBonus + streakBonus;
                score += points;
                streak++;
            } else {
                streak = 0;
            }

            // Move to next question after delay
            setTimeout(() => {
                currentQuestionIndex++;
                showQuestion();
            }, 2000);
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 30;

            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;

                if (timeLeft <= 0) {
                    // Auto-submit with no selection
                    if (selectedAnswer === -1) {
                        selectedAnswer = -2; // Mark as timeout
                        submitAnswer();
                    }
                }
            }, 1000);
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('questionNum').textContent = currentQuestionIndex + 1;
            document.getElementById('streak').textContent = streak;
        }

        function endGame() {
            clearInterval(timerInterval);
            gameStarted = false;

            document.getElementById('gameSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';

            document.getElementById('finalScore').textContent = score;

            // Show achievements
            const achievements = document.getElementById('achievements');
            achievements.innerHTML = '<div class="achievement ' + (score >= 2000 ? 'unlocked' : '') + '">' +
                '&#127942; Quiz Master: Score 2000+ points</div>' +
                '<div class="achievement ' + (streak >= 3 ? 'unlocked' : '') + '">' +
                '&#128293; Hot Streak: 3+ correct answers in a row</div>' +
                '<div class="achievement ' + (score >= 1000 ? 'unlocked' : '') + '">' +
                '&#127919; Sharp Shooter: Score 1000+ points</div>' +
                '<div class="achievement ' + (currentQuestionIndex === questions.length ? 'unlocked' : '') + '">' +
                '&#127937; Completionist: Answer all questions</div>';
        }

            autoSave();
        }

        function retryGame() {
            startGame();
        }

        // Question management functions
        function renderQuestionList() {
            const questionList = document.getElementById('questionList');
            if (questions.length === 0) {
                questionList.innerHTML = '<p style="text-align: center; color: #666;">No questions yet. Click "Add Question" to get started!</p>';
                return;
            }

            questionList.innerHTML = questions.map((q, index) => {
                if (!q || !q.question) return ''; // Skip null or invalid questions
                return `
                <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div style="flex: 1;">
                            <strong>Q${index + 1}:</strong> ${q.question}
                            <div style="margin-top: 5px; font-size: 14px; color: #666;">
                                ${q.options.map((opt, i) => `${i === q.correct ? '✅' : '○'} ${opt}`).join(' • ')}
                            </div>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <button onclick="editQuestion(${index})" style="background: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Edit</button>
                            <button onclick="deleteQuestion(${index})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Delete</button>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function addNewQuestion() {
            editingQuestionIndex = -1;
            document.getElementById('editorTitle').textContent = 'Add New Question';
            document.getElementById('questionText').value = '';
            document.querySelectorAll('.optionText').forEach((input, index) => {
                input.value = index < 2 ? '' : input.value;
            });
            document.querySelector('input[name="correctOption"][value="0"]').checked = true;
            document.getElementById('questionEditor').style.display = 'block';
        }

        function editQuestion(index) {
            const question = questions[index];
            editingQuestionIndex = index;
            document.getElementById('editorTitle').textContent = 'Edit Question';
            document.getElementById('questionText').value = question.question;

            // Update options
            const optionInputs = document.querySelectorAll('.optionText');
            question.options.forEach((opt, i) => {
                if (optionInputs[i]) {
                    optionInputs[i].value = opt;
                }
            });

            // Set correct option
            document.querySelector(`input[name="correctOption"][value="${question.correct}"]`).checked = true;

            document.getElementById('questionEditor').style.display = 'block';
        }

        function saveQuestion() {
            const questionText = document.getElementById('questionText').value.trim();
            const optionInputs = document.querySelectorAll('.optionText');
            const correctOption = parseInt(document.querySelector('input[name="correctOption"]:checked').value);

            const options = Array.from(optionInputs).map(input => input.value.trim()).filter(opt => opt !== '');

            if (!questionText || options.length < 2) {
                alert('Please enter a question and at least 2 options.');
                return;
            }

            const question = {
                question: questionText,
                options: options,
                correct: correctOption
            };

            if (editingQuestionIndex === -1) {
                questions.push(question);
            } else {
                questions[editingQuestionIndex] = question;
            }

            document.getElementById('questionEditor').style.display = 'none';
            renderQuestionList();
            autoSave();
        }

        function cancelEdit() {
            document.getElementById('questionEditor').style.display = 'none';
        }

        function deleteQuestion(index) {
            if (confirm('Are you sure you want to delete this question?')) {
                questions.splice(index, 1);
                renderQuestionList();
                autoSave();
            }
        }

        function addOption() {
            const optionsContainer = document.getElementById('optionsContainer');
            const optionCount = document.querySelectorAll('.option-input').length;
            const newOption = document.createElement('div');
            newOption.className = 'option-input';
            newOption.style.cssText = 'display: flex; gap: 10px; margin-top: 5px;';
            newOption.innerHTML = `
                <input type="text" class="optionText" placeholder="Option ${optionCount + 1}" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <input type="radio" name="correctOption" value="${optionCount}">
                <button onclick="removeOption(this)" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">×</button>
            `;
            optionsContainer.appendChild(newOption);
        }

        function removeOption(button) {
            const optionInput = button.parentElement;
            const optionsContainer = document.getElementById('optionsContainer');
            if (document.querySelectorAll('.option-input').length > 2) {
                optionInput.remove();
            } else {
                alert('You need at least 2 options.');
            }
        }

        function saveQuiz() {
            const quizName = prompt('Enter a name for your quiz:');
            if (quizName) {
                const quizData = {
                    name: quizName,
                    questions: questions,
                    created: new Date().toISOString()
                };
                localStorage.setItem(`quiz_${quizName}`, JSON.stringify(quizData));
                alert('Quiz saved successfully!');
            }
        }

        function loadQuiz() {
            const quizNames = Object.keys(localStorage).filter(key => key.startsWith('quiz_')).map(key => key.replace('quiz_', ''));
            if (quizNames.length === 0) {
                alert('No saved quizzes found.');
                return;
            }

            const quizName = prompt(`Available quizzes:\n${quizNames.join('\n')}\n\nEnter quiz name to load:`);
            if (quizName && quizNames.includes(quizName)) {
                const quizData = JSON.parse(localStorage.getItem(`quiz_${quizName}`));
                questions = quizData.questions;
                renderQuestionList();
                alert(`Quiz "${quizName}" loaded successfully!`);
            }
        }

        function exportQuiz() {
            const quizTitle = prompt('Enter a title for your exported quiz:') || 'My Quiz Game';
            const html = generateQuizHTML(quizTitle);
            downloadFile(`${quizTitle.replace(/\s+/g, '_')}.html`, html);
            alert('Quiz exported successfully!');
        }

        function generateQuizHTML(title) {
            const questionsJson = JSON.stringify(questions, null, 4);
            return `<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title}</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            margin: 0;
            padding: 20px;
        }
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .game-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            min-height: 400px;
        }
        .question-display {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .question-number {
            color: #666;
            margin-bottom: 10px;
        }
        .question-text {
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
        }
        .timer {
            font-size: 48px;
            font-weight: bold;
            color: #dc143c;
            margin: 20px 0;
        }
        .answers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .answer-option {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 16px;
        }
        .answer-option:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        .answer-option.selected {
            background: #dc143c;
            color: white;
        }
        .answer-option.correct {
            background: #28a745;
            color: white;
        }
        .answer-option.incorrect {
            background: #dc3545;
            color: white;
        }
        .game-stats {
            display: flex;
            justify-content: space-around;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #dc143c;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
        }
        .nav-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: #5a6268;
            transform: scale(1.05);
        }
        .start-btn {
            background: #28a745;
        }
        .start-btn:hover {
            background: #218838;
        }
        .results-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .final-score {
            font-size: 64px;
            font-weight: bold;
            color: #dc143c;
            margin: 20px 0;
        }
        .achievement {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .achievement.unlocked {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        .retry-btn {
            background: #dc143c;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        .retry-btn:hover {
            background: #b22222;
            transform: scale(1.05);
        }
        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
            }
            .answers-grid {
                grid-template-columns: 1fr;
            }
            .game-stats {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>${title}</h1>

        <div class="game-section" id="gameSection">
            <div class="game-stats">
                <div class="stat">
                    <div class="stat-number" id="score">0</div>
                    <div class="stat-label">Score</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="questionNum">1</div>
                    <div class="stat-label">Question</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="streak">0</div>
                    <div class="stat-label">Streak</div>
                </div>
                <div class="stat">
                    <div class="timer" id="timer">30</div>
                    <div class="stat-label">Time Left</div>
                </div>
            </div>

            <div class="question-display" id="questionDisplay">
                <div class="question-number">Question 1 of ${questions.length}</div>
                <div class="question-text">Welcome to ${title}!</div>
                <button class="start-btn nav-btn" onclick="startGame()">Start Game</button>
            </div>
        </div>

        <div class="results-section" id="resultsSection" style="display: none;">
            <h2>Game Over!</h2>
            <div class="final-score" id="finalScore">0</div>
            <div id="achievements"></div>
            <button class="retry-btn" onclick="retryGame()">Play Again</button>
        </div>
    </div>

    <script>
        const questions = ${questionsJson};

        let currentQuestionIndex = 0;
        let score = 0;
        let streak = 0;
        let timeLeft = 30;
        let timerInterval;
        let gameStarted = false;
        let selectedAnswer = -1;

        function startGame() {
            gameStarted = true;
            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            timeLeft = 30;
            selectedAnswer = -1;

            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('gameSection').style.display = 'block';

            updateStats();
            showQuestion();
            startTimer();
        }

        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                endGame();
                return;
            }

            const question = questions[currentQuestionIndex];
            const questionDisplay = document.getElementById('questionDisplay');

            questionDisplay.innerHTML =
                '<div class="question-number">Question ' + (currentQuestionIndex + 1) + ' of ' + questions.length + '</div>' +
                '<div class="question-text">' + question.question + '</div>' +
                '<div class="answers-grid" id="answersGrid">' +
                    question.options.map((option, index) =>
                        '<div class="answer-option" onclick="selectAnswer(' + index + ')">' + option + '</div>'
                    ).join('') +
                '</div>' +
                '<button class="nav-btn" onclick="submitAnswer()" id="submitBtn" disabled>Submit Answer</button>';

            selectedAnswer = -1;
            updateStats();
        }

        function selectAnswer(index) {
            if (!gameStarted) return;

            selectedAnswer = index;
            document.querySelectorAll('.answer-option').forEach((el, i) => {
                el.classList.toggle('selected', i === index);
            });
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            if (selectedAnswer === -1) return;

            const question = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.answer-option');

            // Show correct/incorrect
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedAnswer) {
                    option.classList.add('incorrect');
                }
            });

            // Update score
            if (selectedAnswer === question.correct) {
                const timeBonus = Math.max(0, timeLeft * 10);
                const streakBonus = streak * 50;
                const points = 100 + timeBonus + streakBonus;
                score += points;
                streak++;
            } else {
                streak = 0;
            }

            // Move to next question after delay
            setTimeout(() => {
                currentQuestionIndex++;
                showQuestion();
            }, 2000);
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 30;

            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;

                if (timeLeft <= 0) {
                    if (selectedAnswer === -1) {
                        selectedAnswer = -2;
                        submitAnswer();
                    }
                }
            }, 1000);
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('questionNum').textContent = currentQuestionIndex + 1;
            document.getElementById('streak').textContent = streak;
        }

        function endGame() {
            clearInterval(timerInterval);
            gameStarted = false;

            document.getElementById('gameSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';

            document.getElementById('finalScore').textContent = score;

            const achievements = document.getElementById('achievements');
            achievements.innerHTML = '<div class="achievement ' + (score >= 2000 ? 'unlocked' : '') + '">' +
                '&#127942; Quiz Master: Score 2000+ points</div>' +
                '<div class="achievement ' + (streak >= 3 ? 'unlocked' : '') + '">' +
                '&#128293; Hot Streak: 3+ correct answers in a row</div>' +
                '<div class="achievement ' + (score >= 1000 ? 'unlocked' : '') + '">' +
                '&#127919; Sharp Shooter: Score 1000+ points</div>' +
                '<div class="achievement ' + (currentQuestionIndex === questions.length ? 'unlocked' : '') + '">' +
                '&#127937; Completionist: Answer all questions</div>';
        }

        function retryGame() {
            startGame();
        }
    </script>
</body>
</html>`;
        }

        function downloadFile(filename, content) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/html;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function clearAllQuestions() {
            if (confirm('Are you sure you want to delete all questions?')) {
                questions = [];
                renderQuestionList();
                autoSave();
            }
        }
    </script>
    </body>
    </html>

        // Question management functions
        function renderQuestionList() {
            const questionList = document.getElementById('questionList');
            if (questions.length === 0) {
                questionList.innerHTML = '<p style="text-align: center; color: #666;">No questions yet. Click "Add Question" to get started!</p>';
                return;
            }

            questionList.innerHTML = questions.map((q, index) => {
                if (!q || !q.question) return ''; // Skip null or invalid questions
                return `
                <div style="background: white; padding: 15px; border-radius: 10px; margin-bottom: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: flex-start;">
                        <div style="flex: 1;">
                            <strong>Q${index + 1}:</strong> ${q.question}
                            <div style="margin-top: 5px; font-size: 14px; color: #666;">
                                ${q.options.map((opt, i) => `${i === q.correct ? '✅' : '○'} ${opt}`).join(' • ')}
                            </div>
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <button onclick="editQuestion(${index})" style="background: #007bff; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Edit</button>
                            <button onclick="deleteQuestion(${index})" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">Delete</button>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function addNewQuestion() {
            editingQuestionIndex = -1;
            document.getElementById('editorTitle').textContent = 'Add New Question';
            document.getElementById('questionText').value = '';
            document.querySelectorAll('.optionText').forEach((input, index) => {
                input.value = index < 2 ? '' : input.value;
            });
            document.querySelector('input[name="correctOption"][value="0"]').checked = true;
            document.getElementById('questionEditor').style.display = 'block';
        }

        function editQuestion(index) {
            const question = questions[index];
            editingQuestionIndex = index;
            document.getElementById('editorTitle').textContent = 'Edit Question';
            document.getElementById('questionText').value = question.question;

            // Update options
            const optionInputs = document.querySelectorAll('.optionText');
            question.options.forEach((opt, i) => {
                if (optionInputs[i]) {
                    optionInputs[i].value = opt;
                }
            });

            // Set correct option
            document.querySelector(`input[name="correctOption"][value="${question.correct}"]`).checked = true;

            document.getElementById('questionEditor').style.display = 'block';
        }

        function saveQuestion() {
            const questionText = document.getElementById('questionText').value.trim();
            const optionInputs = document.querySelectorAll('.optionText');
            const correctOption = parseInt(document.querySelector('input[name="correctOption"]:checked').value);

            const options = Array.from(optionInputs).map(input => input.value.trim()).filter(opt => opt !== '');

            if (!questionText || options.length < 2) {
                alert('Please enter a question and at least 2 options.');
                return;
            }

            const question = {
                question: questionText,
                options: options,
                correct: correctOption
            };

            if (editingQuestionIndex === -1) {
                questions.push(question);
            } else {
                questions[editingQuestionIndex] = question;
            }

            document.getElementById('questionEditor').style.display = 'none';
            renderQuestionList();
            autoSave();
        }

        function cancelEdit() {
            document.getElementById('questionEditor').style.display = 'none';
        }

        function deleteQuestion(index) {
            if (confirm('Are you sure you want to delete this question?')) {
                questions.splice(index, 1);
                renderQuestionList();
                autoSave();
            }
        }

        function addOption() {
            const optionsContainer = document.getElementById('optionsContainer');
            const optionCount = document.querySelectorAll('.option-input').length;
            const newOption = document.createElement('div');
            newOption.className = 'option-input';
            newOption.style.cssText = 'display: flex; gap: 10px; margin-top: 5px;';
            newOption.innerHTML = `
                <input type="text" class="optionText" placeholder="Option ${optionCount + 1}" style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                <input type="radio" name="correctOption" value="${optionCount}">
                <button onclick="removeOption(this)" style="background: #dc3545; color: white; border: none; padding: 5px 10px; border-radius: 3px; cursor: pointer;">×</button>
            `;
            optionsContainer.appendChild(newOption);
        }

        function removeOption(button) {
            const optionInput = button.parentElement;
            const optionsContainer = document.getElementById('optionsContainer');
            if (document.querySelectorAll('.option-input').length > 2) {
                optionInput.remove();
            } else {
                alert('You need at least 2 options.');
            }
        }

        function saveQuiz() {
            const quizName = prompt('Enter a name for your quiz:');
            if (quizName) {
                const quizData = {
                    name: quizName,
                    questions: questions,
                    created: new Date().toISOString()
                };
                localStorage.setItem(`quiz_${quizName}`, JSON.stringify(quizData));
                alert('Quiz saved successfully!');
            }
        }

        function loadQuiz() {
            const quizNames = Object.keys(localStorage).filter(key => key.startsWith('quiz_')).map(key => key.replace('quiz_', ''));
            if (quizNames.length === 0) {
                alert('No saved quizzes found.');
                return;
            }

            const quizName = prompt(`Available quizzes:\n${quizNames.join('\n')}\n\nEnter quiz name to load:`);
            if (quizName && quizNames.includes(quizName)) {
                const quizData = JSON.parse(localStorage.getItem(`quiz_${quizName}`));
                questions = quizData.questions;
                renderQuestionList();
                alert(`Quiz "${quizName}" loaded successfully!`);
            }
        }

        function exportQuiz() {
            const quizTitle = prompt('Enter a title for your exported quiz:') || 'My Quiz Game';
            const html = generateQuizHTML(quizTitle);
            downloadFile(`${quizTitle.replace(/\s+/g, '_')}.html`, html);
            alert('Quiz exported successfully!');
        }

        function generateQuizHTML(title) {
            const questionsJson = JSON.stringify(questions, null, 4);
            return `<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>${title}</title>
    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-attachment: fixed;
            margin: 0;
            padding: 20px;
        }
        .game-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        .game-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            min-height: 400px;
        }
        .question-display {
            background: white;
            padding: 30px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .question-number {
            color: #666;
            margin-bottom: 10px;
        }
        .question-text {
            font-size: 24px;
            margin-bottom: 20px;
            color: #333;
        }
        .timer {
            font-size: 48px;
            font-weight: bold;
            color: #dc143c;
            margin: 20px 0;
        }
        .answers-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }
        .answer-option {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 16px;
        }
        .answer-option:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }
        .answer-option.selected {
            background: #dc143c;
            color: white;
        }
        .answer-option.correct {
            background: #28a745;
            color: white;
        }
        .answer-option.incorrect {
            background: #dc3545;
            color: white;
        }
        .game-stats {
            display: flex;
            justify-content: space-around;
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 32px;
            font-weight: bold;
            color: #dc143c;
        }
        .stat-label {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
        }
        .nav-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px;
            transition: all 0.3s ease;
        }
        .nav-btn:hover {
            background: #5a6268;
            transform: scale(1.05);
        }
        .start-btn {
            background: #28a745;
        }
        .start-btn:hover {
            background: #218838;
        }
        .results-section {
            background: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .final-score {
            font-size: 64px;
            font-weight: bold;
            color: #dc143c;
            margin: 20px 0;
        }
        .achievement {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }
        .achievement.unlocked {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        .retry-btn {
            background: #dc143c;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 18px;
            font-weight: 600;
            margin-top: 20px;
            transition: all 0.3s ease;
        }
        .retry-btn:hover {
            background: #b22222;
            transform: scale(1.05);
        }
        @media (max-width: 768px) {
            .game-container {
                padding: 20px;
            }
            .answers-grid {
                grid-template-columns: 1fr;
            }
            .game-stats {
                flex-direction: column;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>${title}</h1>

        <div class="game-section" id="gameSection">
            <div class="game-stats">
                <div class="stat">
                    <div class="stat-number" id="score">0</div>
                    <div class="stat-label">Score</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="questionNum">1</div>
                    <div class="stat-label">Question</div>
                </div>
                <div class="stat">
                    <div class="stat-number" id="streak">0</div>
                    <div class="stat-label">Streak</div>
                </div>
                <div class="stat">
                    <div class="timer" id="timer">30</div>
                    <div class="stat-label">Time Left</div>
                </div>
            </div>

            <div class="question-display" id="questionDisplay">
                <div class="question-number">Question 1 of ${questions.length}</div>
                <div class="question-text">Welcome to ${title}!</div>
                <button class="start-btn nav-btn" onclick="startGame()">Start Game</button>
            </div>
        </div>

        <div class="results-section" id="resultsSection" style="display: none;">
            <h2>Game Over!</h2>
            <div class="final-score" id="finalScore">0</div>
            <div id="achievements"></div>
            <button class="retry-btn" onclick="retryGame()">Play Again</button>
        </div>
    </div>

    <script>
        const questions = ${questionsJson};

        let currentQuestionIndex = 0;
        let score = 0;
        let streak = 0;
        let timeLeft = 30;
        let timerInterval;
        let gameStarted = false;
        let selectedAnswer = -1;

        function startGame() {
            gameStarted = true;
            currentQuestionIndex = 0;
            score = 0;
            streak = 0;
            timeLeft = 30;
            selectedAnswer = -1;

            document.getElementById('resultsSection').style.display = 'none';
            document.getElementById('gameSection').style.display = 'block';

            updateStats();
            showQuestion();
            startTimer();
        }

        function showQuestion() {
            if (currentQuestionIndex >= questions.length) {
                endGame();
                return;
            }

            const question = questions[currentQuestionIndex];
            const questionDisplay = document.getElementById('questionDisplay');

            questionDisplay.innerHTML =
                '<div class="question-number">Question ' + (currentQuestionIndex + 1) + ' of ' + questions.length + '</div>' +
                '<div class="question-text">' + question.question + '</div>' +
                '<div class="answers-grid" id="answersGrid">' +
                    question.options.map((option, index) =>
                        '<div class="answer-option" onclick="selectAnswer(' + index + ')">' + option + '</div>'
                    ).join('') +
                '</div>' +
                '<button class="nav-btn" onclick="submitAnswer()" id="submitBtn" disabled>Submit Answer</button>';

            selectedAnswer = -1;
            updateStats();
        }

        function selectAnswer(index) {
            if (!gameStarted) return;

            selectedAnswer = index;
            document.querySelectorAll('.answer-option').forEach((el, i) => {
                el.classList.toggle('selected', i === index);
            });
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            if (selectedAnswer === -1) return;

            const question = questions[currentQuestionIndex];
            const options = document.querySelectorAll('.answer-option');

            // Show correct/incorrect
            options.forEach((option, index) => {
                if (index === question.correct) {
                    option.classList.add('correct');
                } else if (index === selectedAnswer) {
                    option.classList.add('incorrect');
                }
            });

            // Update score
            if (selectedAnswer === question.correct) {
                const timeBonus = Math.max(0, timeLeft * 10);
                const streakBonus = streak * 50;
                const points = 100 + timeBonus + streakBonus;
                score += points;
                streak++;
            } else {
                streak = 0;
            }

            // Move to next question after delay
            setTimeout(() => {
                currentQuestionIndex++;
                showQuestion();
            }, 2000);
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 30;

            timerInterval = setInterval(() => {
                timeLeft--;
                document.getElementById('timer').textContent = timeLeft;

                if (timeLeft <= 0) {
                    if (selectedAnswer === -1) {
                        selectedAnswer = -2;
                        submitAnswer();
                    }
                }
            }, 1000);
        }

        function updateStats() {
            document.getElementById('score').textContent = score;
            document.getElementById('questionNum').textContent = currentQuestionIndex + 1;
            document.getElementById('streak').textContent = streak;
        }

        function endGame() {
            clearInterval(timerInterval);
            gameStarted = false;

            document.getElementById('gameSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';

            document.getElementById('finalScore').textContent = score;

            const achievements = document.getElementById('achievements');
            achievements.innerHTML = '<div class="achievement ' + (score >= 2000 ? 'unlocked' : '') + '">' +
                '&#127942; Quiz Master: Score 2000+ points</div>' +
                '<div class="achievement ' + (streak >= 3 ? 'unlocked' : '') + '">' +
                '&#128293; Hot Streak: 3+ correct answers in a row</div>' +
                '<div class="achievement ' + (score >= 1000 ? 'unlocked' : '') + '">' +
                '&#127919; Sharp Shooter: Score 1000+ points</div>' +
                '<div class="achievement ' + (currentQuestionIndex === questions.length ? 'unlocked' : '') + '">' +
                '&#127937; Completionist: Answer all questions</div>';
        }

        function retryGame() {
            startGame();
        }
    </script>
</body>
</html>`;
        }

        function downloadFile(filename, content) {
            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/html;charset=utf-8,' + encodeURIComponent(content));
            element.setAttribute('download', filename);
            element.style.display = 'none';
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }

        function clearAllQuestions() {
            if (confirm('Are you sure you want to delete all questions?')) {
                questions = [];
                renderQuestionList();
                autoSave();
            }
        }
    </script>
    </body>
    </html>